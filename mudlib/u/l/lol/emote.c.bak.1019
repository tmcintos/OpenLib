// emote.h
// Daemon designed to handle emotes in every way.
// Lol   10/17/95

#include <command.h>


int main(string str) {
string verb, this_emote, room_emote, emote_file;
  string *word=explode(str," ");
  int i=sizeof(word);
  int j=sizeof(word);
  if(!str) {
    notify_fail("You exist.\n");
    return 0;
  }
  this_emote="You ";
  room_emote=capitalize(this_player()->query_name()) + " ";
  for(i=0; i<j; i++) {
  if(sscanf(word[i],"%*ss")) { verb="es"; }
    else { verb="s"; }
    emote_file="/cmd/emotes/"+word[i];
    if(file_size(emote_file) > 0) {
      if(j==1) {
      this_emote += word[i] + " " + read_file(emote_file);
    room_emote += word[i] + verb + " " + read_file(emote_file);
      } else {
        this_emote += word[i];
        room_emote += word[i]+verb;
      }

    } else {
    if(!i) {
        this_emote += word[i];
        room_emote += word[i]+verb;
      }
      else {
        this_emote +=word[i];
        room_emote +=word[i];
      }
    }
  if(i<j-1) {
       this_emote += " ";
       room_emote += " ";
     }
}

  this_emote = replace_string(this_emote,"\n", "");
  room_emote = replace_string(room_emote, "\n", "");
  tell_object(this_player(),this_emote+".\n");
  tell_room(environment(this_player()),room_emote+".\n");
  return 1;
}
